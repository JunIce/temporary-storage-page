<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="format-detection" content="telephone=no">
    <title>æ–‡ä»¶ç³»ç»Ÿ</title>
    <style>
        /* CSSå˜é‡å®šä¹‰ */
        :root {
            --primary-color: #4e54c8;
            --secondary-color: #8f94fb;
            --success-color: #28a745;
            --danger-color: #dc3545;
            --warning-color: #ffc107;
            --info-color: #17a2b8;
            --light-color: #f8f9fa;
            --dark-color: #343a40;
            --border-radius: 12px;
            --border-radius-lg: 20px;
            --border-radius-xl: 25px;
            --box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            --box-shadow-lg: 0 8px 25px rgba(0, 0, 0, 0.15);
            --transition: all 0.3s ease;
        }

        /* --- å…¨å±€é‡ç½®ä¸åŸºç¡€æ ·å¼ --- */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            /* ç»Ÿä¸€ä½¿ç”¨æ€æºé»‘ä½“/è‹¹æ–¹ç­‰ç°ä»£ä¸­æ–‡å­—ä½“ */
            font-family: 'PingFang SC', 'Microsoft YaHei', 'Helvetica Neue', Arial, sans-serif, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto;
            /* æ›´æœ‰æ´»åŠ›çš„èƒŒæ™¯æ¸å˜ */
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            /* ç§»åŠ¨ç«¯ä¼˜åŒ– */
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            text-rendering: optimizeLegibility;
        }

        /* --- è¯­è¨€é€‰æ‹©å™¨æ ·å¼ --- */
        .language-selector {
            position: absolute;
            top: 20px;
            right: 20px;
            z-index: 100;
        }

        .language-btn {
            background: rgba(255, 255, 255, 0.9);
            border: 2px solid var(--primary-color);
            border-radius: 25px;
            padding: 8px 16px;
            font-size: 14px;
            font-weight: 600;
            color: var(--primary-color);
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            backdrop-filter: blur(10px);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .language-btn:hover {
            background: var(--primary-color);
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(78, 84, 200, 0.3);
        }

        .language-btn:active {
            transform: translateY(0);
        }

        .language-flag {
            font-size: 16px;
        }

        /* --- GitHubé“¾æ¥æ ·å¼ --- */
        .github-link {
            position: absolute;
            top: 20px;
            right: 160px;
            z-index: 100;
        }

        .github-btn {
            background: rgba(255, 255, 255, 0.9);
            border: 2px solid #333;
            border-radius: 50%;
            width: 44px;
            height: 44px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            text-decoration: none;
            color: #333;
        }

        .github-btn:hover {
            background: #333;
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(51, 51, 51, 0.3);
        }

        .github-btn:active {
            transform: translateY(0);
        }

        .github-btn svg {
            width: 20px;
            height: 20px;
        }

        /* --- ä¸»å®¹å™¨æ ·å¼ --- */
        .container {
            /* æ›´æŸ”å’Œçš„ç™½è‰²é€æ˜åº¦ */
            background: rgba(255, 255, 255, 0.98);
            border-radius: 25px; /* å¢åŠ åœ†è§’ */
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.15), 0 0 0 1px rgba(255, 255, 255, 0.5) inset; /* æ›´å¥½çš„é˜´å½± */
            padding: 40px;
            max-width: 850px;
            width: 100%;
            backdrop-filter: blur(15px); /* ç•¥å¾®å¢å¼ºæ¨¡ç³Šæ•ˆæœ */
            position: relative;
        }

        /* --- æ ‡é¢˜æ ·å¼ --- */
        h1 {
            text-align: center;
            margin-bottom: 40px;
            font-size: 2.8em;
            /* ä¿æŒæ¸å˜æ–‡æœ¬æ•ˆæœ */
            background: linear-gradient(135deg, #4e54c8 0%, #8f94fb 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-weight: 800; /* åŠ ç²— */
            letter-spacing: 1px;
        }

        /* --- ä¸Šä¼ åŒºåŸŸæ ·å¼ --- */
        .upload-area {
            border: 4px dashed #667eea; /* ç¨å¾®ç²—ä¸€ç‚¹çš„è™šçº¿ */
            border-radius: 20px;
            padding: 50px 40px;
            text-align: center;
            transition: all 0.4s cubic-bezier(0.25, 0.8, 0.25, 1);
            cursor: pointer;
            background: #ffffff;
            margin-bottom: 30px;
            color: #6c757d;
            font-size: 1.1em;
            font-weight: 500;
        }

        .upload-area:hover {
            border-color: #4e54c8;
            background: #f5f7fa;
        }

        .upload-area.dragover {
            border-color: #4e54c8;
            background: #e9ecef;
            transform: scale(1.01);
            box-shadow: 0 0 0 8px rgba(78, 84, 200, 0.1);
        }

        .upload-icon {
            font-size: 5em; /* ç•¥å¾®å¢å¤§å›¾æ ‡ */
            color: #667eea;
            margin-bottom: 20px;
            line-height: 1;
        }

        .file-input {
            display: none;
        }

        .btn {
            background: linear-gradient(135deg, #4e54c8 0%, #8f94fb 100%);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(78, 84, 200, 0.3);
            display: inline-flex;
            align-items: center;
            gap: 8px;
            font-weight: 600;
            min-width: 100px;
            justify-content: center;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(78, 84, 200, 0.4);
        }

        .btn:active {
            transform: translateY(0);
            box-shadow: 0 2px 8px rgba(78, 84, 200, 0.3);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .btn-secondary {
            background: linear-gradient(135deg, #6c757d 0%, #495057 100%);
            box-shadow: 0 4px 15px rgba(108, 117, 125, 0.3);
        }

        .btn-secondary:hover {
            box-shadow: 0 6px 20px rgba(108, 117, 125, 0.4);
        }

        .btn-danger {
            background: linear-gradient(135deg, #dc3545 0%, #fd7e14 100%);
            box-shadow: 0 4px 15px rgba(220, 53, 69, 0.3);
        }

        .btn-danger:hover {
            box-shadow: 0 6px 20px rgba(220, 53, 69, 0.4);
        }



        .uploading-animation {
            display: inline-block;
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.4; } /* ç¨å¾®é™ä½æœ€å°ä¸é€æ˜åº¦ */
            100% { opacity: 1; }
        }

        /* --- ç»Ÿä¸€ä¸Šä¼ å¡ç‰‡æ ·å¼ --- */
        .upload-card {
            background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
            border: 1px solid #e9ecef;
            border-radius: 20px;
            padding: 0;
            margin: 20px 0;
            display: none;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.08);
            overflow: hidden;
            position: relative;
        }

        .upload-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #4e54c8 0%, #8f94fb 100%);
        }

        .upload-card-header {
            padding: 25px 30px 20px;
            border-bottom: 1px solid #f1f3f4;
            background: rgba(78, 84, 200, 0.03);
        }

        .upload-card-title {
            font-size: 1.3em;
            font-weight: 700;
            color: #333;
            margin: 0 0 15px 0;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .upload-card-title::before {
            content: 'ğŸ“„';
            font-size: 1.1em;
        }

        .file-info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-bottom: 10px;
        }

        .file-info-item {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .file-info-label {
            font-size: 12px;
            color: #666;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .file-info-value {
            font-size: 14px;
            color: #333;
            font-weight: 600;
            word-break: break-all;
        }

        .upload-card-body {
            padding: 25px 30px;
        }

        .progress-section {
            margin-bottom: 25px;
        }

        .progress-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .progress-title {
            font-size: 1.1em;
            font-weight: 600;
            color: #333;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .progress-title::before {
            content: 'â³';
            font-size: 1em;
        }

        .progress-percentage {
            font-size: 1.3em;
            font-weight: 800;
            color: #4e54c8;
            background: rgba(78, 84, 200, 0.1);
            padding: 5px 12px;
            border-radius: 20px;
            min-width: 60px;
            text-align: center;
        }

        .progress-bar {
            width: 100%;
            height: 12px;
            background: #e9ecef;
            border-radius: 6px;
            overflow: hidden;
            position: relative;
            box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.1);
            margin-bottom: 15px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #4e54c8 0%, #8f94fb 100%);
            width: 0%;
            transition: width 0.6s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            border-radius: 6px;
        }

        .progress-fill::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(
                90deg,
                transparent,
                rgba(255, 255, 255, 0.6),
                transparent
            );
            animation: shimmer 2s infinite;
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(400%); }
        }

        .progress-stats {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 13px;
            color: #666;
            font-weight: 500;
        }

        .stat-item {
            display: flex;
            align-items: center;
            gap: 5px;
            padding: 5px 10px;
            background: rgba(78, 84, 200, 0.05);
            border-radius: 15px;
        }

        .stat-item.upload-speed {
            color: #28a745;
        }

        .stat-item.chunk-info {
            color: #4e54c8;
        }

        .stat-item.time-remaining {
            color: #dc3545;
        }

        .upload-card-footer {
            padding: 20px 30px 25px;
            background: rgba(78, 84, 200, 0.02);
            border-top: 1px solid #f1f3f4;
        }

        .controls {
            display: flex;
            gap: 10px;
            justify-content: center;
            flex-wrap: wrap;
        }

        /* --- å†å²è®°å½•æ ·å¼ --- */
        .history {
            margin-top: 40px;
        }

        .history h2 {
            color: #333;
            margin-bottom: 20px;
            font-size: 1.8em;
            font-weight: 700;
        }

        .history-item {
            background: #ffffff;
            padding: 18px 20px;
            border-radius: 12px;
            margin-bottom: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s ease;
            border: 1px solid #e9ecef;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
        }

        .history-item:hover {
            background: #f5f7fa;
            transform: translateY(-2px);
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.1);
        }

        .history-info {
            flex: 1;
        }

        .history-name {
            font-weight: 700;
            color: #333;
            margin-bottom: 5px;
            font-size: 1.1em;
        }

        .history-meta {
            font-size: 13px;
            color: #777;
        }

        .history-actions {
            display: flex;
            gap: 12px;
            align-items: center;
        }

        .history-item-link {
            color: white;
            background: linear-gradient(135deg, #4e54c8 0%, #8f94fb 100%);
            text-decoration: none;
            padding: 8px 18px;
            border: none;
            border-radius: 25px;
            transition: all 0.3s ease;
            font-weight: 600;
            font-size: 13px;
        }

        .history-item-link:hover {
            opacity: 0.9;
            box-shadow: 0 4px 10px rgba(78, 84, 200, 0.3);
        }

        .btn-resume, .btn-cancel {
            /* ç»Ÿä¸€å°æŒ‰é’®æ ·å¼ */
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 25px;
            font-size: 13px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 5px;
            font-weight: 500;
        }

        .btn-resume {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            box-shadow: 0 2px 8px rgba(40, 167, 69, 0.3);
        }

        .btn-resume:hover {
            background: linear-gradient(135deg, #218838 0%, #1ba87e 100%);
            transform: translateY(-1px);
        }

        .btn-cancel {
            background: linear-gradient(135deg, #dc3545 0%, #fd7e14 100%);
            box-shadow: 0 2px 8px rgba(220, 53, 69, 0.3);
        }

        .btn-cancel:hover {
            background: linear-gradient(135deg, #c82333 0%, #fd9843 100%);
            transform: translateY(-1px);
        }

        /* --- å¼¹çª—æ ·å¼ --- */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100vw;
            height: 100vh;
            background-color: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(5px);
            animation: fadeIn 0.3s ease;
        }

        .modal.show {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .modal-content {
            background: white;
            border-radius: 20px;
            padding: 30px;
            max-width: 450px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            animation: slideIn 0.3s ease;
            position: relative;
            margin: 20px;
        }

        @keyframes slideIn {
            from { 
                transform: translateY(-50px) scale(0.9);
                opacity: 0;
            }
            to { 
                transform: translateY(0) scale(1);
                opacity: 1;
            }
        }

        .modal-header {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
            gap: 15px;
        }

        .modal-icon {
            font-size: 2em;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        .modal-icon.success {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            color: white;
        }

        .modal-icon.error {
            background: linear-gradient(135deg, #dc3545 0%, #fd7e14 100%);
            color: white;
        }

        .modal-icon.info {
            background: linear-gradient(135deg, #4e54c8 0%, #8f94fb 100%);
            color: white;
        }

        .modal-title {
            font-size: 1.4em;
            font-weight: 700;
            color: #333;
            margin: 0;
        }

        .modal-body {
            color: #666;
            font-size: 1em;
            line-height: 1.6;
            margin-bottom: 25px;
        }

        .modal-footer {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }

        .modal-btn {
            padding: 10px 25px;
            border: none;
            border-radius: 25px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
        }

        .modal-btn-primary {
            background: linear-gradient(135deg, #4e54c8 0%, #8f94fb 100%);
            color: white;
            box-shadow: 0 4px 15px rgba(78, 84, 200, 0.3);
        }

        .modal-btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(78, 84, 200, 0.4);
        }

        .modal-btn-secondary {
            background: #f8f9fa;
            color: #666;
            border: 1px solid #e9ecef;
        }

        .modal-btn-secondary:hover {
            background: #e9ecef;
        }

        /* --- å†å²è®°å½•çŠ¶æ€æ ·å¼ --- */
        .history-item.uploading {
            border-left: 4px solid #ffc107;
            background: linear-gradient(135deg, #fff9e6 0%, #ffffff 100%);
        }

        .history-item.completed {
            border-left: 4px solid #28a745;
            background: linear-gradient(135deg, #e8f5e8 0%, #ffffff 100%);
        }

        .history-item.failed {
            border-left: 4px solid #dc3545;
            background: linear-gradient(135deg, #ffeaea 0%, #ffffff 100%);
        }

        .status-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .status-badge.uploading {
            background: linear-gradient(135deg, #ffc107 0%, #ff9800 100%);
            color: white;
        }

        .status-badge.completed {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            color: white;
        }

        .status-badge.failed {
            background: linear-gradient(135deg, #dc3545 0%, #fd7e14 100%);
            color: white;
        }

        /* --- å†å²è®°å½•æ ·å¼ --- */
        .history {
            margin-top: 40px;
        }

        .history h2 {
            color: #333;
            margin-bottom: 20px;
            font-size: 1.8em;
            font-weight: 700;
        }

        .history-item {
            background: #ffffff;
            padding: 18px 20px;
            border-radius: 12px;
            margin-bottom: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s ease;
            border: 1px solid #e9ecef;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
        }

        .history-item:hover {
            background: #f5f7fa;
            transform: translateY(-2px);
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.1);
        }

        .history-info {
            flex: 1;
        }

        .history-name {
            font-weight: 700;
            color: #333;
            margin-bottom: 5px;
            font-size: 1.1em;
        }

        .history-meta {
            font-size: 13px;
            color: #777;
        }

        .history-actions {
            display: flex;
            gap: 12px;
            align-items: center;
        }

        .history-item-link {
            color: white;
            background: linear-gradient(135deg, #4e54c8 0%, #8f94fb 100%);
            text-decoration: none;
            padding: 8px 18px;
            border: none;
            border-radius: 25px;
            transition: all 0.3s ease;
            font-weight: 600;
            font-size: 13px;
        }

        .history-item-link:hover {
            opacity: 0.9;
            box-shadow: 0 4px 10px rgba(78, 84, 200, 0.3);
        }

        .btn-resume, .btn-cancel {
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 25px;
            font-size: 13px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 5px;
            font-weight: 500;
        }

        .btn-resume {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            box-shadow: 0 2px 8px rgba(40, 167, 69, 0.3);
        }

        .btn-resume:hover {
            background: linear-gradient(135deg, #218838 0%, #1ba87e 100%);
            transform: translateY(-1px);
        }

        .btn-cancel {
            background: linear-gradient(135deg, #dc3545 0%, #fd7e14 100%);
            box-shadow: 0 2px 8px rgba(220, 53, 69, 0.3);
        }

        .btn-cancel:hover {
            background: linear-gradient(135deg, #c82333 0%, #fd9843 100%);
            transform: translateY(-1px);
        }

        /* --- å¼¹çª—æ ·å¼ --- */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100vw;
            height: 100vh;
            background-color: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(5px);
            animation: fadeIn 0.3s ease;
        }

        .modal.show {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .modal-content {
            background: white;
            border-radius: 20px;
            padding: 30px;
            max-width: 450px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            animation: slideIn 0.3s ease;
            position: relative;
            margin: 20px;
        }

        @keyframes slideIn {
            from { 
                transform: translateY(-50px) scale(0.9);
                opacity: 0;
            }
            to { 
                transform: translateY(0) scale(1);
                opacity: 1;
            }
        }

        .modal-header {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
            gap: 15px;
        }

        .modal-icon {
            font-size: 2em;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        .modal-icon.success {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            color: white;
        }

        .modal-icon.error {
            background: linear-gradient(135deg, #dc3545 0%, #fd7e14 100%);
            color: white;
        }

        .modal-icon.info {
            background: linear-gradient(135deg, #4e54c8 0%, #8f94fb 100%);
            color: white;
        }

        .modal-title {
            font-size: 1.4em;
            font-weight: 700;
            color: #333;
            margin: 0;
        }

        .modal-body {
            color: #666;
            font-size: 1em;
            line-height: 1.6;
            margin-bottom: 25px;
        }

        .modal-footer {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }

        .modal-btn {
            padding: 10px 25px;
            border: none;
            border-radius: 25px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
        }

        .modal-btn-primary {
            background: linear-gradient(135deg, #4e54c8 0%, #8f94fb 100%);
            color: white;
            box-shadow: 0 4px 15px rgba(78, 84, 200, 0.3);
        }

        .modal-btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(78, 84, 200, 0.4);
        }

        .modal-btn-secondary {
            background: #f8f9fa;
            color: #666;
            border: 1px solid #e9ecef;
        }

        .modal-btn-secondary:hover {
            background: #e9ecef;
        }

        /* --- å†å²è®°å½•çŠ¶æ€æ ·å¼ --- */
        .history-item.uploading {
            border-left: 4px solid #ffc107;
            background: linear-gradient(135deg, #fff9e6 0%, #ffffff 100%);
        }

        .history-item.completed {
            border-left: 4px solid #28a745;
            background: linear-gradient(135deg, #e8f5e8 0%, #ffffff 100%);
        }

        .history-item.failed {
            border-left: 4px solid #dc3545;
            background: linear-gradient(135deg, #ffeaea 0%, #ffffff 100%);
        }

        .status-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .status-badge.uploading {
            background: linear-gradient(135deg, #ffc107 0%, #ff9800 100%);
            color: white;
        }

        .status-badge.completed {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            color: white;
        }

        .status-badge.failed {
            background: linear-gradient(135deg, #dc3545 0%, #fd7e14 100%);
            color: white;
        }

        /* --- çŠ¶æ€ä¿¡æ¯æ ·å¼ --- */
        .status {
            padding: 15px 25px;
            border-radius: 12px;
            font-size: 15px;
            margin: 15px 0;
            display: none;
            font-weight: 600;
            text-align: center;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        .status.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .status.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .controls {
            text-align: center;
            margin: 30px 0;
        }

        /* ä¿®å¤åŸæ¥çš„æ ·å¼ä¸­é‡å¤å®šä¹‰çš„ formatFileSize */
        .chunk-info {
            font-size: 13px; /* è°ƒæ•´ä¸ºä¸ progress-stats ä¸­çš„å®šä¹‰ä¸€è‡´ */
            color: #4e54c8;
            margin-top: 0; /* ç§»é™¤å¤šä½™çš„ margin-top */
        }

        /* --- æ–‡ä»¶ä¿å­˜æœŸé™æç¤ºæ ·å¼ --- */
        .storage-notice {
            position: fixed;
            bottom: 20px;
            left: 20px;
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a52 100%);
            color: white;
            padding: 12px 20px;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(238, 90, 82, 0.3);
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
            font-weight: 500;
            z-index: 100;
            animation: slideInLeft 0.5s ease-out;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            max-width: 300px;
        }

        .notice-icon {
            font-size: 16px;
            animation: pulse 2s infinite;
        }

        .notice-text {
            flex: 1;
            line-height: 1.4;
        }

        @keyframes slideInLeft {
            from {
                transform: translateX(-100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        @keyframes pulse {
            0%, 100% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.1);
            }
        }

        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 768px) {
            /* å®¹å™¨è°ƒæ•´ */
            .container {
                padding: 20px;
                margin: 10px;
                max-width: none;
                width: calc(100% - 20px);
            }

            /* æ ‡é¢˜è°ƒæ•´ */
            h1 {
                font-size: 24px;
                margin-bottom: 20px;
            }

            h2 {
                font-size: 20px;
                margin-bottom: 15px;
            }

            /* ç§»åŠ¨ç«¯GitHubé“¾æ¥æ ·å¼ */
            .github-link {
                right: 80px;
                top: 15px;
            }

            .github-btn {
                width: 38px;
                height: 38px;
            }

            .github-btn svg {
                width: 18px;
                height: 18px;
            }

            /* ç§»åŠ¨ç«¯è¯­è¨€é€‰æ‹©å™¨æ ·å¼ */
            .language-selector {
                top: 15px;
                right: 15px;
            }

            .language-btn {
                padding: 6px 12px;
                font-size: 12px;
            }

            .language-flag {
                font-size: 14px;
            }

            /* ä¸Šä¼ åŒºåŸŸè°ƒæ•´ */
            .upload-area {
                padding: 40px 20px;
                min-height: 120px;
            }

            .upload-icon {
                font-size: 48px;
                margin-bottom: 15px;
            }

            .upload-area p {
                font-size: 16px;
                margin: 0;
            }

            /* ä¸Šä¼ å¡ç‰‡è°ƒæ•´ */
            .upload-card {
                margin: 20px 0;
                padding: 20px;
            }

            .upload-card-header {
                margin-bottom: 20px;
            }

            .upload-card-title {
                font-size: 18px;
                margin-bottom: 15px;
            }

            /* æ–‡ä»¶ä¿¡æ¯ç½‘æ ¼è°ƒæ•´ */
            .file-info-grid {
                grid-template-columns: 1fr;
                gap: 12px;
            }

            .file-info-item {
                flex-direction: row;
                justify-content: space-between;
                align-items: center;
                padding: 10px;
                background: rgba(78, 84, 200, 0.05);
                border-radius: 8px;
            }

            .file-info-label {
                font-size: 13px;
                color: #666;
                margin-bottom: 0;
            }

            .file-info-value {
                font-size: 14px;
                font-weight: 600;
                text-align: right;
                word-break: break-all;
                max-width: 60%;
            }

            /* è¿›åº¦æ¡è°ƒæ•´ */
            .progress-section {
                margin: 20px 0;
            }

            .progress-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 8px;
                margin-bottom: 15px;
            }

            .progress-title {
                font-size: 16px;
            }

            .progress-percentage {
                font-size: 18px;
                align-self: flex-end;
            }

            .progress-bar {
                height: 8px;
                margin-bottom: 15px;
            }

            /* è¿›åº¦ç»Ÿè®¡è°ƒæ•´ */
            .progress-stats {
                flex-direction: column;
                gap: 10px;
            }

            .stat-item {
                justify-content: space-between;
                padding: 8px 12px;
                background: rgba(78, 84, 200, 0.05);
                border-radius: 6px;
            }

            .stat-item span:first-child {
                font-size: 14px;
            }

            .stat-item span:last-child {
                font-size: 12px;
                font-weight: 600;
            }

            /* æŒ‰é’®ç»„è°ƒæ•´ */
            .controls {
                display: flex;
                flex-wrap: wrap;
                gap: 10px;
                justify-content: center;
                margin: 20px 0;
            }

            .btn {
                flex: 1;
                min-width: calc(50% - 5px);
                max-width: calc(50% - 5px);
                padding: 12px 16px;
                font-size: 14px;
            }

            .btn-secondary {
                min-width: calc(33.33% - 7px);
                max-width: calc(33.33% - 7px);
            }

            .btn-danger {
                min-width: calc(33.33% - 7px);
                max-width: calc(33.33% - 7px);
            }

            /* å†å²è®°å½•è°ƒæ•´ */
            .history {
                margin: 20px 0;
            }

            .history-item {
                padding: 15px;
                margin-bottom: 10px;
            }

            .history-item-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 8px;
            }

            .history-item-name {
                font-size: 14px;
                word-break: break-all;
            }

            .history-item-meta {
                font-size: 12px;
            }

            /* å¼¹çª—è°ƒæ•´ */
            .modal-content {
                margin: 20px;
                padding: 20px;
                max-width: calc(100vw - 40px);
                width: calc(100vw - 40px);
            }

            .modal-header {
                margin-bottom: 15px;
            }

            .modal-title {
                font-size: 18px;
            }

            .modal-body {
                font-size: 14px;
                margin-bottom: 20px;
            }

            .modal-btn {
                padding: 12px 24px;
                font-size: 14px;
            }

            /* æ–‡ä»¶ä¿å­˜æœŸé™æç¤ºè°ƒæ•´ */
            .storage-notice {
                bottom: 15px;
                left: 15px;
                right: 15px;
                max-width: none;
                font-size: 13px;
                padding: 12px 15px;
                border-radius: 8px;
            }
        }

        /* è¶…å°å±å¹•ä¼˜åŒ– (iPhone SEç­‰) */
        @media (max-width: 375px) {
            .container {
                padding: 15px;
                margin: 5px;
                width: calc(100% - 10px);
            }

            h1 {
                font-size: 20px;
            }

            .upload-area {
                padding: 30px 15px;
                min-height: 100px;
            }

            .upload-icon {
                font-size: 40px;
            }

            .upload-area p {
                font-size: 14px;
            }

            .btn {
                padding: 10px 12px;
                font-size: 13px;
            }

            .file-info-value {
                font-size: 12px;
            }

            .storage-notice {
                font-size: 12px;
                padding: 10px 12px;
            }

            /* ç§»åŠ¨ç«¯è§¦æ‘¸ä¼˜åŒ– */
            .btn {
                min-height: 44px; /* iOSæ¨èçš„æœ€å°è§¦æ‘¸ç›®æ ‡ */
                touch-action: manipulation; /* ç¦ç”¨åŒå‡»ç¼©æ”¾ */
                user-select: none; /* é˜²æ­¢æ–‡æœ¬é€‰æ‹© */
                -webkit-tap-highlight-color: transparent; /* ç§»é™¤ç‚¹å‡»é«˜äº® */
            }

            .upload-area {
                touch-action: manipulation;
                -webkit-tap-highlight-color: transparent;
            }

            /* ç§»åŠ¨ç«¯æ»šåŠ¨ä¼˜åŒ– */
            body {
                -webkit-overflow-scrolling: touch; /* iOSå¹³æ»‘æ»šåŠ¨ */
                overscroll-behavior: contain; /* é˜²æ­¢è¿‡åº¦æ»šåŠ¨ */
            }

            /* ç§»åŠ¨ç«¯è¾“å…¥ä¼˜åŒ– */
            .file-input {
                touch-action: manipulation;
            }
        }

        /* æ¨ªå±æ¨¡å¼ä¼˜åŒ– */
        @media (max-width: 768px) and (orientation: landscape) {
            .container {
                padding: 15px;
            }

            .upload-area {
                padding: 20px 15px;
                min-height: 80px;
            }

            .upload-icon {
                font-size: 36px;
                margin-bottom: 10px;
            }

            .upload-area p {
                font-size: 14px;
            }

            .file-info-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 10px;
            }

            .progress-stats {
                flex-direction: row;
                flex-wrap: wrap;
                gap: 8px;
            }

            .stat-item {
                flex: 1;
                min-width: calc(33.33% - 6px);
            }

            .btn {
                min-width: 80px;
                max-width: 120px;
            }

            /* æ¨ªå±æ¨¡å¼GitHubé“¾æ¥æ ·å¼ */
            .github-link {
                right: 120px;
                top: 10px;
            }

            .github-btn {
                width: 36px;
                height: 36px;
            }

            .github-btn svg {
                width: 16px;
                height: 16px;
            }

            /* æ¨ªå±æ¨¡å¼è¯­è¨€é€‰æ‹©å™¨æ ·å¼ */
            .language-selector {
                top: 10px;
                right: 10px;
            }

            .language-btn {
                padding: 5px 10px;
                font-size: 11px;
            }

            .language-flag {
                font-size: 12px;
            }
        }

        /* å¹³æ¿è®¾å¤‡ä¼˜åŒ– */
        @media (min-width: 769px) and (max-width: 1024px) {
            .container {
                padding: 30px;
                margin: 20px auto;
                max-width: 90%;
            }

            .file-info-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .controls {
                gap: 15px;
            }

            .btn {
                min-width: 120px;
            }

            /* å¹³æ¿è®¾å¤‡GitHubé“¾æ¥æ ·å¼ */
            .github-link {
                right: 140px;
                top: 18px;
            }

            .github-btn {
                width: 42px;
                height: 42px;
            }

            .github-btn svg {
                width: 19px;
                height: 19px;
            }

            /* å¹³æ¿è®¾å¤‡è¯­è¨€é€‰æ‹©å™¨æ ·å¼ */
            .language-selector {
                top: 18px;
                right: 18px;
            }

            .language-btn {
                padding: 7px 14px;
                font-size: 13px;
            }

            .language-flag {
                font-size: 15px;
            }
        }
    </style>
</head>
<body>
    <!-- è¯­è¨€é€‰æ‹©å™¨ -->
    <div class="language-selector">
        <button class="language-btn" onclick="toggleLanguage()" id="languageBtn">
            <span class="language-flag" id="languageFlag">ğŸ‡¨ğŸ‡³</span>
            <span id="languageText">ä¸­æ–‡</span>
        </button>
    </div>

    <!-- GitHubé“¾æ¥ -->
    <div class="github-link">
        <a href="https://github.com/JunIce/temporary-storage-page" target="_blank" class="github-btn" title="GitHub">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
            </svg>
        </a>
    </div>

    <div class="container">
        <h1 data-i18n="pageTitle">æ–‡ä»¶ç³»ç»Ÿ</h1>
        
        <div class="upload-area" id="uploadArea">
            <div class="upload-icon">ğŸ“</div>
            <p data-i18n="uploadAreaText">æ‹–æ‹½æ–‡ä»¶åˆ°æ­¤å¤„æˆ–ç‚¹å‡»é€‰æ‹©æ–‡ä»¶</p>
            <input type="file" id="fileInput" class="file-input">
        </div>

        <div class="upload-card" id="uploadCard">
            <div class="upload-card-header">
                <h3 class="upload-card-title" data-i18n="fileInfo">æ–‡ä»¶ä¿¡æ¯</h3>
                <div class="file-info-grid">
                    <div class="file-info-item">
                        <span class="file-info-label" data-i18n="fileName">æ–‡ä»¶å</span>
                        <span class="file-info-value" id="fileName">-</span>
                    </div>
                    <div class="file-info-item">
                        <span class="file-info-label" data-i18n="fileSize">æ–‡ä»¶å¤§å°</span>
                        <span class="file-info-value" id="fileSize">-</span>
                    </div>
                    <div class="file-info-item">
                        <span class="file-info-label" data-i18n="fileType">æ–‡ä»¶ç±»å‹</span>
                        <span class="file-info-value" id="fileType">-</span>
                    </div>
                    <div class="file-info-item">
                        <span class="file-info-label" data-i18n="lastModified">æœ€åä¿®æ”¹</span>
                        <span class="file-info-value" id="lastModified">-</span>
                    </div>
                </div>
            </div>
            
            <div class="upload-card-body">
                <div class="progress-section">
                    <div class="progress-header">
                        <div class="progress-title" data-i18n="uploadProgress">ä¸Šä¼ è¿›åº¦</div>
                        <div class="progress-percentage" id="progressPercentage">0%</div>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill"></div>
                    </div>
                    <div class="progress-stats">
                        <div class="stat-item upload-speed">
                            <span>âš¡</span>
                            <span id="uploadSpeed">0 KB/s</span>
                        </div>
                        <div class="stat-item chunk-info">
                            <span>ğŸ“¦</span>
                            <span id="chunkInfo" data-i18n="chunkInfo">0/0 åˆ†ç‰‡</span>
                        </div>
                        <div class="stat-item time-remaining">
                            <span>â°</span>
                            <span id="timeRemaining" data-i18n="calculating">è®¡ç®—ä¸­...</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="upload-card-footer">
                <div class="controls">
                    <button class="btn" id="uploadBtn">
                        <span class="uploading-animation">ğŸš€</span>
                        <span data-i18n="startUpload">å¼€å§‹ä¸Šä¼ </span>
                    </button>
                    <button class="btn btn-secondary" id="pauseBtn" disabled>
                        <span class="uploading-animation">â¸ï¸</span>
                        <span data-i18n="pause">æš‚åœ</span>
                    </button>
                    <button class="btn btn-secondary" id="resumeBtn" disabled>
                        <span class="uploading-animation">â–¶ï¸</span>
                        <span data-i18n="resume">ç»§ç»­</span>
                    </button>
                    <button class="btn btn-danger" id="cancelBtn">
                        <span class="uploading-animation">âŒ</span>
                        <span data-i18n="cancel">å–æ¶ˆ</span>
                    </button>
                </div>
            </div>
        </div>

        <div class="status" id="status"></div>

        <div class="history" id="history">
            <h2 data-i18n="uploadHistory">ä¸Šä¼ å†å²</h2>
            <div id="historyList"></div>
        </div>
    </div>

    <!-- å¼¹çª— -->
    <div class="modal" id="modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-icon" id="modalIcon">âœ“</div>
                <h3 class="modal-title" id="modalTitle" data-i18n="tip">æç¤º</h3>
            </div>
            <div class="modal-body" id="modalBody" data-i18n="operationComplete">
                æ“ä½œå®Œæˆ
            </div>
            <div class="modal-footer">
                <button class="modal-btn modal-btn-primary" onclick="fileUploader.closeModal()" data-i18n="confirm">ç¡®å®š</button>
            </div>
        </div>
    </div>

    <!-- æ–‡ä»¶ä¿å­˜æœŸé™æç¤º -->
    <div class="storage-notice">
        <span class="notice-icon">â°</span>
        <span class="notice-text" data-i18n="storageNotice">æ–‡ä»¶ä¸Šä¼ åä»…ä¿å­˜2å¤©ï¼Œè¯·åŠæ—¶ä¸‹è½½</span>
    </div>

    <script>
        // å›½é™…åŒ–é…ç½®
        const i18n = {
            currentLang: 'zh-CN',
            translations: {
                'zh-CN': {
                    title: 'æ–‡ä»¶ç³»ç»Ÿ',
                    pageTitle: 'æ–‡ä»¶ç³»ç»Ÿ',
                    uploadAreaText: 'æ‹–æ‹½æ–‡ä»¶åˆ°æ­¤å¤„æˆ–ç‚¹å‡»é€‰æ‹©æ–‡ä»¶',
                    fileInfo: 'æ–‡ä»¶ä¿¡æ¯',
                    fileName: 'æ–‡ä»¶å',
                    fileSize: 'æ–‡ä»¶å¤§å°',
                    fileType: 'æ–‡ä»¶ç±»å‹',
                    lastModified: 'æœ€åä¿®æ”¹',
                    uploadProgress: 'ä¸Šä¼ è¿›åº¦',
                    chunkInfo: '{0}/{1} åˆ†ç‰‡',
                    calculating: 'è®¡ç®—ä¸­...',
                    startUpload: 'å¼€å§‹ä¸Šä¼ ',
                    pause: 'æš‚åœ',
                    resume: 'ç»§ç»­',
                    cancel: 'å–æ¶ˆ',
                    uploadHistory: 'ä¸Šä¼ å†å²',
                    tip: 'æç¤º',
                    operationComplete: 'æ“ä½œå®Œæˆ',
                    confirm: 'ç¡®å®š',
                    storageNotice: 'æ–‡ä»¶ä¸Šä¼ åä»…ä¿å­˜2å¤©ï¼Œè¯·åŠæ—¶ä¸‹è½½',
                    uploading: 'ä¸Šä¼ ä¸­',
                    completed: 'å·²å®Œæˆ',
                    failed: 'å¤±è´¥',
                    resumeUpload: 'ç»§ç»­ä¸Šä¼ ',
                    download: 'ä¸‹è½½',
                    deleteRecord: 'åˆ é™¤è®°å½•',
                    recordDeleted: 'è®°å½•å·²åˆ é™¤',
                    deleteSuccess: 'åˆ é™¤æˆåŠŸ',
                    deleteFailed: 'åˆ é™¤è®°å½•å¤±è´¥',
                    noUploadRecords: 'æš‚æ— ä¸Šä¼ è®°å½•',
                    unknown: 'æœªçŸ¥',
                    continueUpload: 'â–¶ï¸ ç»§ç»­ä¸Šä¼ ',
                    deleteRecordBtn: 'âŒ åˆ é™¤è®°å½•',
                    languageText: 'ä¸­æ–‡'
                },
                'en-US': {
                    title: 'File System',
                    pageTitle: 'File System',
                    uploadAreaText: 'Drag files here or click to select files',
                    fileInfo: 'File Information',
                    fileName: 'File Name',
                    fileSize: 'File Size',
                    fileType: 'File Type',
                    lastModified: 'Last Modified',
                    uploadProgress: 'Upload Progress',
                    chunkInfo: '{0}/{1} Chunks',
                    calculating: 'Calculating...',
                    startUpload: 'Start Upload',
                    pause: 'Pause',
                    resume: 'Resume',
                    cancel: 'Cancel',
                    uploadHistory: 'Upload History',
                    tip: 'Notice',
                    operationComplete: 'Operation Complete',
                    confirm: 'OK',
                    storageNotice: 'Files are saved for only 2 days after upload, please download in time',
                    uploading: 'Uploading',
                    completed: 'Completed',
                    failed: 'Failed',
                    resumeUpload: 'Resume Upload',
                    download: 'Download',
                    deleteRecord: 'Delete Record',
                    recordDeleted: 'Record Deleted',
                    deleteSuccess: 'Delete Success',
                    deleteFailed: 'Failed to Delete Record',
                    noUploadRecords: 'No Upload Records',
                    unknown: 'Unknown',
                    continueUpload: 'â–¶ï¸ Resume Upload',
                    deleteRecordBtn: 'âŒ Delete Record',
                    languageText: 'English'
                }
            }
        };

        // è¯­è¨€åˆ‡æ¢åŠŸèƒ½
        function toggleLanguage() {
            const currentLang = i18n.currentLang;
            const newLang = currentLang === 'zh-CN' ? 'en-US' : 'zh-CN';
            setLanguage(newLang);
        }

        function setLanguage(lang) {
            i18n.currentLang = lang;
            
            // æ›´æ–°HTML langå±æ€§
            const htmlElement = document.getElementById('htmlLang');
            if (htmlElement) {
                htmlElement.setAttribute('lang', lang);
            }
            
            // æ›´æ–°è¯­è¨€æŒ‰é’®
            const languageBtn = document.getElementById('languageBtn');
            const languageFlag = document.getElementById('languageFlag');
            const languageText = document.getElementById('languageText');
            
            if (languageFlag && languageText) {
                if (lang === 'zh-CN') {
                    languageFlag.textContent = 'ğŸ‡¨ğŸ‡³';
                    languageText.textContent = 'ä¸­æ–‡';
                } else {
                    languageFlag.textContent = 'ğŸ‡ºğŸ‡¸';
                    languageText.textContent = 'English';
                }
            }
            
            // æ›´æ–°æ‰€æœ‰å¸¦æœ‰data-i18nå±æ€§çš„å…ƒç´ 
            updateAllTranslations();
            
            // ä¿å­˜è¯­è¨€è®¾ç½®åˆ°localStorage
            localStorage.setItem('preferredLanguage', lang);
        }

        function updateAllTranslations() {
            const elements = document.querySelectorAll('[data-i18n]');
            elements.forEach(element => {
                const key = element.getAttribute('data-i18n');
                const translation = i18n.translations[i18n.currentLang][key];
                if (translation) {
                    // å¤„ç†åŒ…å«å ä½ç¬¦çš„ç¿»è¯‘
                    if (key === 'chunkInfo') {
                        // å¯¹äºåˆ†ç‰‡ä¿¡æ¯ï¼Œä¿æŒåŸæœ‰çš„åŠ¨æ€æ›´æ–°é€»è¾‘
                        return;
                    }
                    element.textContent = translation;
                }
            });
        }

        function t(key, ...args) {
            let translation = i18n.translations[i18n.currentLang][key] || key;
            
            // å¤„ç†å ä½ç¬¦
            if (args.length > 0) {
                args.forEach((arg, index) => {
                    translation = translation.replace(`{${index}}`, arg);
                });
            }
            
            return translation;
        }

        // é¡µé¢åŠ è½½æ—¶æ¢å¤è¯­è¨€è®¾ç½®
        function initLanguage() {
            const savedLang = localStorage.getItem('preferredLanguage') || 'zh-CN';
            i18n.currentLang = savedLang; // å…ˆè®¾ç½®è¯­è¨€ï¼Œé¿å…åç»­è°ƒç”¨t()å‡½æ•°æ—¶å‡ºé”™
        }

        // æœåŠ¡å™¨APIé…ç½®
        const API_CONFIG = {
            baseUrl: window.location.origin,
            endpoints: {
                initUpload: '/api/upload/init',
                uploadChunk: '/api/upload/chunk',
                completeUpload: '/api/upload/complete',
                cancelUpload: '/api/upload',
                uploadStatus: '/api/upload',
                singleUpload: '/api/upload/single',
                listFiles: '/api/files',
                deleteFile: '/api/files'
            }
        };

        // ä¸Šä¼ é…ç½®
        const CHUNK_SIZE = 5 * 1024 * 1024; // 5MB
        const MAX_RETRIES = 3;

        class FileUploader {
            constructor() {
                this.file = null;
                this.uploadId = null;
                this.chunks = [];
                this.uploadedChunks = new Set();
                this.isPaused = false;
                this.isUploading = false;
                this.db = null;
                this.currentUpload = null;
                
                this.initDB().then(() => {
                    this.bindEvents();
                    this.loadHistory();
                }).catch(error => {
                    console.error('åˆå§‹åŒ–æ•°æ®åº“å¤±è´¥:', error);
                    this.bindEvents(); // å³ä½¿æ•°æ®åº“åˆå§‹åŒ–å¤±è´¥ï¼Œä¹Ÿè¦ç»‘å®šäº‹ä»¶
                });
            }

            async initDB() {
                return new Promise((resolve, reject) => {
                    const request = indexedDB.open('FileUploadDB', 1);
                    
                    request.onerror = () => reject(request.error);
                    request.onsuccess = () => {
                        this.db = request.result;
                        resolve();
                    };
                    
                    request.onupgradeneeded = (event) => {
                        const db = event.target.result;
                        if (!db.objectStoreNames.contains('uploads')) {
                            const store = db.createObjectStore('uploads', { keyPath: 'uploadId' });
                            store.createIndex('filename', 'filename', { unique: false });
                            store.createIndex('timestamp', 'timestamp', { unique: false });
                        }
                        if (!db.objectStoreNames.contains('chunks')) {
                            const store = db.createObjectStore('chunks', { keyPath: 'id' });
                            store.createIndex('uploadId', 'uploadId', { unique: false });
                        }
                    };
                });
            }

            bindEvents() {
                const uploadArea = document.getElementById('uploadArea');
                const fileInput = document.getElementById('fileInput');
                
                uploadArea.addEventListener('click', () => fileInput.click());
                uploadArea.addEventListener('dragover', this.handleDragOver.bind(this));
                uploadArea.addEventListener('drop', this.handleDrop.bind(this));
                uploadArea.addEventListener('dragleave', this.handleDragLeave.bind(this));
                
                fileInput.addEventListener('change', (e) => this.handleFileSelect(e.target.files[0]));
                
                document.getElementById('uploadBtn').addEventListener('click', () => this.startUpload());
                document.getElementById('pauseBtn').addEventListener('click', () => this.pauseUpload());
                document.getElementById('resumeBtn').addEventListener('click', () => this.resumeUpload());
                document.getElementById('cancelBtn').addEventListener('click', () => this.cancelUpload());
            }

            handleDragOver(e) {
                e.preventDefault();
                document.getElementById('uploadArea').classList.add('dragover');
            }

            handleDragLeave(e) {
                e.preventDefault();
                document.getElementById('uploadArea').classList.remove('dragover');
            }

            handleDrop(e) {
                e.preventDefault();
                document.getElementById('uploadArea').classList.remove('dragover');
                const file = e.dataTransfer.files[0];
                this.handleFileSelect(file);
            }

            handleFileSelect(file) {
                if (!file) return;
                
                this.file = file;
                this.displayFileInfo(file);
                this.checkResumeCapability(file);
                document.getElementById('controls').style.display = 'block';
            }

            displayFileInfo(file) {
                const uploadCard = document.getElementById('uploadCard');
                document.getElementById('fileName').textContent = file.name;
                document.getElementById('fileSize').textContent = this.formatFileSize(file.size);
                document.getElementById('fileType').textContent = file.type || (i18n.translations[i18n.currentLang]?.unknown || 'æœªçŸ¥');
                document.getElementById('lastModified').textContent = new Date(file.lastModified).toLocaleString();
                uploadCard.style.display = 'block';
            }

            formatFileSize(bytes) {
                if (bytes === 0) return '0 Bytes';
                const k = 1024;
                const sizes = ['Bytes', 'KB', 'MB', 'GB'];
                const i = Math.floor(Math.log(bytes) / Math.log(k));
                return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
            }

            async checkResumeCapability(file) {
                if (!this.db) {
                    console.log('æ•°æ®åº“æœªåˆå§‹åŒ–ï¼Œè·³è¿‡æ¢å¤æ£€æŸ¥');
                    return;
                }
                
                const transaction = this.db.transaction(['uploads'], 'readonly');
                const store = transaction.objectStore('uploads');
                const index = store.index('filename');
                
                const request = index.getAll(file.name);
                request.onsuccess = () => {
                    const uploads = request.result;
                    const incompleteUpload = uploads.find(u => u.status === 'uploading');
                    
                    if (incompleteUpload) {
                        this.showModal('æ£€æµ‹åˆ°æœªå®Œæˆçš„ä¸Šä¼ ä»»åŠ¡ï¼Œå¯ä»¥é€‰æ‹©ç»§ç»­ä¸Šä¼ ', 'info', 'æ¢å¤ä¸Šä¼ ');
                        document.getElementById('resumeBtn').disabled = false;
                        this.currentUpload = incompleteUpload;
                    }
                };
            }

            async startUpload() {
                if (!this.file) return;
                
                this.isUploading = true;
                this.isPaused = false;
                this.updateButtons();
                
                try {
                    // åˆå§‹åŒ–åˆ†ç‰‡ä¸Šä¼ 
                    const uploadId = await this.initMultipartUpload();
                    this.uploadId = uploadId;
                    
                    // ç«‹å³ä¿å­˜ä¸Šä¼ è®°å½•
                    this.saveUploadRecord('uploading');
                    
                    // åˆ›å»ºåˆ†ç‰‡
                    this.createChunks();
                    
                    // å¼€å§‹ä¸Šä¼ åˆ†ç‰‡
                    await this.uploadChunks();
                    
                } catch (error) {
                    this.showStatus(`ä¸Šä¼ å¤±è´¥: ${error.message}`, 'error');
                    this.saveUploadRecord('failed');
                    this.resetUploadState();
                }
            }

            async initMultipartUpload() {
                try {
                    const response = await fetch(`${API_CONFIG.baseUrl}${API_CONFIG.endpoints.initUpload}`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({
                            fileName: this.file.name,
                            fileSize: this.file.size,
                            chunkSize: CHUNK_SIZE
                        })
                    });
                    
                    if (!response.ok) {
                        throw new Error(`åˆå§‹åŒ–ä¸Šä¼ å¤±è´¥: ${response.statusText}`);
                    }
                    
                    const data = await response.json();
                    return data.uploadId;
                } catch (error) {
                    console.error('åˆå§‹åŒ–åˆ†ç‰‡ä¸Šä¼ å¤±è´¥:', error);
                    throw error;
                }
            }

            createChunks() {
                this.chunks = [];
                const totalChunks = Math.ceil(this.file.size / CHUNK_SIZE);
                
                for (let i = 0; i < totalChunks; i++) {
                    const start = i * CHUNK_SIZE;
                    const end = Math.min(start + CHUNK_SIZE, this.file.size);
                    
                    this.chunks.push({
                        index: i,
                        start,
                        end,
                        size: end - start,
                        retries: 0
                    });
                }
            }

            async uploadChunks() {
                const totalChunks = this.chunks.length;
                let uploadedCount = this.uploadedChunks.size;
                let startTime = Date.now();
                let lastUploadedSize = 0;
                let lastUpdateTime = startTime;
                
                for (const chunk of this.chunks) {
                    if (this.uploadedChunks.has(chunk.index)) continue;
                    if (this.isPaused) break;
                    
                    try {
                        const chunkStartTime = Date.now();
                        await this.uploadChunk(chunk);
                        const chunkEndTime = Date.now();
                        
                        this.uploadedChunks.add(chunk.index);
                        uploadedCount++;
                        
                        // è®¡ç®—ä¸Šä¼ é€Ÿåº¦å’Œå‰©ä½™æ—¶é—´
                        const currentTime = Date.now();
                        const elapsedTime = (currentTime - startTime) / 1000; // ç§’
                        const uploadedSize = uploadedCount * CHUNK_SIZE;
                        
                        let uploadSpeed = 0;
                        let timeRemaining = null;
                        
                        if (elapsedTime > 0) {
                            uploadSpeed = uploadedSize / elapsedTime; // å­—èŠ‚/ç§’
                            
                            if (uploadSpeed > 0) {
                                const remainingSize = this.file.size - uploadedSize;
                                timeRemaining = remainingSize / uploadSpeed; // ç§’
                            }
                        }
                        
                        // æ›´æ–°è¿›åº¦
                        const progress = (uploadedCount / totalChunks) * 100;
                        this.updateProgress(progress, uploadedCount, totalChunks, uploadSpeed, timeRemaining);
                        
                        // ä¿å­˜åˆ†ç‰‡ä¸Šä¼ çŠ¶æ€
                        this.saveChunkStatus(chunk.index);
                        
                    } catch (error) {
                        if (chunk.retries < MAX_RETRIES) {
                            chunk.retries++;
                            console.log(`åˆ†ç‰‡ ${chunk.index} ä¸Šä¼ å¤±è´¥ï¼Œé‡è¯• ${chunk.retries}/${MAX_RETRIES}`);
                            continue;
                        } else {
                            throw new Error(`åˆ†ç‰‡ ${chunk.index} ä¸Šä¼ å¤±è´¥: ${error.message}`);
                        }
                    }
                }
                
                if (!this.isPaused && uploadedCount === totalChunks) {
                    // å®Œæˆä¸Šä¼ 
                    const downloadUrl = await this.completeUpload();
                    this.showModal('æ–‡ä»¶ä¸Šä¼ å®Œæˆï¼', 'success', 'ä¸Šä¼ æˆåŠŸ');
                    this.saveUploadRecord('completed', downloadUrl);
                    this.loadHistory();
                    
                    // é‡ç½®ä¸Šä¼ çŠ¶æ€
                    this.resetUploadState();
                }
            }

            async uploadChunk(chunk) {
                const blob = this.file.slice(chunk.start, chunk.end);
                const formData = new FormData();
                formData.append('chunk', blob);
                formData.append('uploadId', this.uploadId);
                formData.append('chunkIndex', chunk.index);
                
                try {
                    const response = await fetch(`${API_CONFIG.baseUrl}${API_CONFIG.endpoints.uploadChunk}`, {
                        method: 'POST',
                        body: formData
                    });
                    
                    if (!response.ok) {
                        throw new Error(`åˆ†ç‰‡ä¸Šä¼ å¤±è´¥: ${response.statusText}`);
                    }
                    
                    const data = await response.json();
                    console.log(`åˆ†ç‰‡ ${chunk.index} ä¸Šä¼ æˆåŠŸ`, data);
                    return data;
                } catch (error) {
                    console.error(`åˆ†ç‰‡ ${chunk.index} ä¸Šä¼ å¤±è´¥:`, error);
                    throw error;
                }
            }

            async completeUpload() {
                try {
                    const response = await fetch(`${API_CONFIG.baseUrl}${API_CONFIG.endpoints.completeUpload}`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({
                            uploadId: this.uploadId
                        })
                    });
                    
                    if (!response.ok) {
                        throw new Error(`å®Œæˆä¸Šä¼ å¤±è´¥: ${response.statusText}`);
                    }
                    
                    const data = await response.json();
                    return data.downloadUrl;
                } catch (error) {
                    console.error('å®Œæˆä¸Šä¼ å¤±è´¥:', error);
                    throw error;
                }
            }

            pauseUpload() {
                this.isPaused = true;
                this.isUploading = false;
                this.updateButtons();
                this.showModal('ä¸Šä¼ å·²æš‚åœ', 'info', 'æš‚åœä¸Šä¼ ');
            }

            resumeUpload() {
                if (this.uploadId && this.file) {
                    // å¦‚æœæœ‰å½“å‰çš„ä¸Šä¼ ä»»åŠ¡ï¼Œç»§ç»­ä¸Šä¼ 
                    this.isPaused = false;
                    this.isUploading = true;
                    this.uploadChunks();
                } else {
                    this.showModal('æ²¡æœ‰å¯æ¢å¤çš„ä¸Šä¼ ä»»åŠ¡', 'error', 'æ— æ³•æ¢å¤');
                }
                this.updateButtons();
            }

            async resumeFromHistory(uploadId) {
                if (!this.db) {
                    console.error('æ•°æ®åº“æœªåˆå§‹åŒ–ï¼Œæ— æ³•æ¢å¤ä¸Šä¼ ');
                    return;
                }
                
                try {
                    // ä»IndexedDBè·å–ä¸Šä¼ è®°å½•
                    const uploadTransaction = this.db.transaction(['uploads'], 'readonly');
                    const uploadStore = uploadTransaction.objectStore('uploads');
                    const uploadRequest = uploadStore.get(uploadId);
                    
                    uploadRequest.onsuccess = async () => {
                        const uploadRecord = uploadRequest.result;
                        if (!uploadRecord) {
                            this.showModal('æ‰¾ä¸åˆ°ä¸Šä¼ è®°å½•', 'error', 'æ¢å¤å¤±è´¥');
                            return;
                        }

                        // æ¢å¤æ–‡ä»¶ä¿¡æ¯
                        this.file = {
                            name: uploadRecord.filename,
                            size: uploadRecord.size,
                            type: uploadRecord.type
                        };
                        this.uploadId = uploadRecord.uploadId;

                        // æ˜¾ç¤ºæ–‡ä»¶ä¿¡æ¯
                        this.displayFileInfo(this.file); // ä¿®æ­£ï¼šéœ€è¦ä¼ å…¥æ–‡ä»¶å¯¹è±¡

                        // ä»IndexedDBæ¢å¤åˆ†ç‰‡çŠ¶æ€
                        const chunkTransaction = this.db.transaction(['chunks'], 'readonly');
                        const chunkStore = chunkTransaction.objectStore('chunks');
                        const chunkIndex = chunkStore.index('uploadId');
                        
                        const chunkRequest = chunkIndex.getAll(uploadId);
                        chunkRequest.onsuccess = () => {
                            const chunks = chunkRequest.result;
                            chunks.forEach(chunk => {
                                this.uploadedChunks.add(chunk.chunkIndex);
                            });
                            
                            // é‡æ–°åˆ›å»ºåˆ†ç‰‡å¹¶ç»§ç»­ä¸Šä¼ 
                            this.createChunks();
                            this.isUploading = true;
                            this.isPaused = false;
                            this.updateButtons();
                            this.uploadChunks();
                        };
                    };
                } catch (error) {
                    console.error('æ¢å¤ä¸Šä¼ å¤±è´¥:', error);
                    this.showModal('æ¢å¤ä¸Šä¼ å¤±è´¥', 'error', 'æ¢å¤å¤±è´¥');
                }
            }

            cancelUpload(uploadId = null) {
                if (uploadId) {
                    // å–æ¶ˆæŒ‡å®šçš„ä¸Šä¼ ä»»åŠ¡
                    this.deleteHistoryRecord(uploadId);
                } else {
                    // å–æ¶ˆå½“å‰çš„ä¸Šä¼ ä»»åŠ¡
                    this.resetUploadState();
                    this.showModal('ä¸Šä¼ å·²å–æ¶ˆ', 'info', 'å–æ¶ˆä¸Šä¼ ');
                }
            }

            resetUploadState() {
                // é‡ç½®æ‰€æœ‰ä¸Šä¼ ç›¸å…³çš„çŠ¶æ€
                this.isUploading = false;
                this.isPaused = false;
                this.uploadId = null;
                this.file = null;
                this.chunks = [];
                this.uploadedChunks.clear();
                this.currentUpload = null;
                
                // é‡ç½®UIçŠ¶æ€
                this.updateButtons();
                document.getElementById('uploadCard').style.display = 'none';
                
                // é‡ç½®æ–‡ä»¶è¾“å…¥
                document.getElementById('fileInput').value = '';
            }

            updateProgress(progress, uploaded = 0, total = 0, uploadSpeed = 0, timeRemaining = null) {
                document.getElementById('progressFill').style.width = `${progress}%`;
                document.getElementById('progressPercentage').textContent = `${Math.round(progress)}%`;
                
                if (uploaded > 0 && total > 0) {
                    const translations = i18n.translations[i18n.currentLang] || i18n.translations['zh-CN'];
                    const template = translations.chunkInfo || '{0}/{1} åˆ†ç‰‡';
                    document.getElementById('chunkInfo').textContent = template.replace('{0}', uploaded).replace('{1}', total);
                }
                
                if (uploadSpeed > 0) {
                    const speedText = uploadSpeed > 1024 * 1024 ? 
                        `${(uploadSpeed / (1024 * 1024)).toFixed(1)} MB/s` : 
                        `${(uploadSpeed / 1024).toFixed(1)} KB/s`;
                    document.getElementById('uploadSpeed').textContent = speedText;
                }
                
                if (timeRemaining !== null) {
                    const timeText = timeRemaining === Infinity ? 'è®¡ç®—ä¸­...' : 
                        this.formatTime(timeRemaining);
                    document.getElementById('timeRemaining').textContent = timeText;
                }
            }

            formatTime(seconds) {
                if (seconds < 60) {
                    return `${Math.round(seconds)}ç§’`;
                } else if (seconds < 3600) {
                    return `${Math.floor(seconds / 60)}åˆ†${Math.round(seconds % 60)}ç§’`;
                } else {
                    const hours = Math.floor(seconds / 3600);
                    const minutes = Math.floor((seconds % 3600) / 60);
                    return `${hours}æ—¶${minutes}åˆ†`;
                }
            }

            updateButtons() {
                const uploadBtn = document.getElementById('uploadBtn');
                const pauseBtn = document.getElementById('pauseBtn');
                const resumeBtn = document.getElementById('resumeBtn');
                const cancelBtn = document.getElementById('cancelBtn');

                if (this.isUploading) {
                    uploadBtn.disabled = true;
                    pauseBtn.disabled = this.isPaused;
                    resumeBtn.style.display = this.isPaused ? 'inline-flex' : 'none';
                    cancelBtn.disabled = false;
                } else {
                    uploadBtn.disabled = false;
                    pauseBtn.disabled = true;
                    resumeBtn.style.display = 'none';
                    cancelBtn.disabled = true;
                }
            }

            showStatus(message, type) {
                // æ”¹ä¸ºå¼¹çª—æ˜¾ç¤º
                this.showModal(message, type);
            }

            showModal(message, type = 'info', title = null) {
                const modal = document.getElementById('modal');
                const modalIcon = document.getElementById('modalIcon');
                const modalTitle = document.getElementById('modalTitle');
                const modalBody = document.getElementById('modalBody');

                // è®¾ç½®å›¾æ ‡å’Œæ ·å¼
                modalIcon.className = `modal-icon ${type}`;
                switch(type) {
                    case 'success':
                        modalIcon.textContent = 'âœ“';
                        modalTitle.textContent = title || 'æˆåŠŸ';
                        break;
                    case 'error':
                        modalIcon.textContent = 'âœ•';
                        modalTitle.textContent = title || 'é”™è¯¯';
                        break;
                    case 'info':
                    default:
                        modalIcon.textContent = 'â„¹';
                        modalTitle.textContent = title || 'æç¤º';
                        break;
                }

                modalBody.textContent = message;
                modal.classList.add('show');

                // 3ç§’åè‡ªåŠ¨å…³é—­
                setTimeout(() => {
                    this.closeModal();
                }, 3000);
            }

            closeModal() {
                const modal = document.getElementById('modal');
                modal.classList.remove('show');
            }

            async saveUploadRecord(status, downloadUrl = null) {
                if (!this.db) {
                    console.log('æ•°æ®åº“æœªåˆå§‹åŒ–ï¼Œè·³è¿‡ä¿å­˜ä¸Šä¼ è®°å½•');
                    return;
                }
                
                if (!this.uploadId) {
                    console.log('æ²¡æœ‰uploadIdï¼Œè·³è¿‡ä¿å­˜ä¸Šä¼ è®°å½•');
                    return;
                }
                
                const record = {
                    uploadId: this.uploadId,
                    filename: this.file.name,
                    size: this.file.size,
                    type: this.file.type,
                    timestamp: new Date().toISOString(),
                    status,
                    downloadUrl
                };
                
                const transaction = this.db.transaction(['uploads'], 'readwrite');
                const store = transaction.objectStore('uploads');
                store.put(record);
            }

            saveChunkStatus(chunkIndex) {
                if (!this.db) {
                    console.log('æ•°æ®åº“æœªåˆå§‹åŒ–ï¼Œè·³è¿‡ä¿å­˜åˆ†ç‰‡çŠ¶æ€');
                    return;
                }
                
                const chunkRecord = {
                    id: `${this.uploadId}_${chunkIndex}`,
                    uploadId: this.uploadId,
                    chunkIndex,
                    timestamp: new Date().toISOString()
                };
                
                const transaction = this.db.transaction(['chunks'], 'readwrite');
                const store = transaction.objectStore('chunks');
                store.put(chunkRecord);
            }

            loadHistory() {
                if (!this.db) {
                    console.log('æ•°æ®åº“æœªåˆå§‹åŒ–ï¼Œè·³è¿‡åŠ è½½å†å²è®°å½•');
                    document.getElementById('historyList').innerHTML = '<p style="text-align: center; color: #999;">æš‚æ— ä¸Šä¼ è®°å½•</p>';
                    return;
                }
                
                const transaction = this.db.transaction(['uploads'], 'readonly');
                const store = transaction.objectStore('uploads');
                const index = store.index('timestamp');
                
                const request = index.openCursor(null, 'prev');
                const history = [];
                
                request.onsuccess = (event) => {
                    const cursor = event.target.result;
                    if (cursor && history.length < 10) {
                        history.push(cursor.value);
                        cursor.continue();
                    } else {
                        this.displayHistory(history);
                    }
                };
            }

            displayHistory(history) {
            const historyContainer = document.getElementById('historyList');
            const translations = i18n.translations[i18n.currentLang] || i18n.translations['zh-CN'];
            
            if (!history || history.length === 0) {
                historyContainer.innerHTML = `<p style="text-align: center; color: #999;">${translations.noUploadRecords}</p>`;
                return;
            }

            historyContainer.innerHTML = history.map(record => {
                const statusText = this.getStatusText(record.status);
                const statusClass = record.status;
                
                return `
                <div class="history-item ${statusClass}" data-upload-id="${record.uploadId}">
                    <div class="history-info">
                        <div class="history-name">${record.filename}</div>
                        <div class="history-meta">
                            ${this.formatFileSize(record.size)} â€¢ 
                            <span class="status-badge ${statusClass}">${statusText}</span> â€¢ 
                            ${new Date(record.timestamp).toLocaleString()}
                        </div>
                    </div>
                    <div class="history-actions">
                        ${record.status === 'uploading' ? 
                            `<button class="btn-resume" onclick="fileUploader.resumeFromHistory('${record.uploadId}')">
                                ${translations.continueUpload}
                            </button>` : ''
                        }
                        ${record.downloadUrl ? 
                            `<a href="${record.downloadUrl}" target="_blank" class="history-item-link">${translations.download}</a>` : ''
                        }
                        <button class="btn-cancel" onclick="fileUploader.deleteHistoryRecord('${record.uploadId}')">
                            ${translations.deleteRecordBtn}
                        </button>
                    </div>
                </div>
            `;
            }).join('');
        }

            getStatusText(status) {
            const translations = i18n.translations[i18n.currentLang] || i18n.translations['zh-CN'];
            const statusMap = {
                'uploading': translations.uploading,
                'completed': translations.completed,
                'failed': translations.failed
            };
            return statusMap[status] || translations.unknown || 'æœªçŸ¥';
        }

            formatFileSize(bytes) {
                if (bytes === 0) return '0 Bytes';
                const k = 1024;
                const sizes = ['Bytes', 'KB', 'MB', 'GB'];
                const i = Math.floor(Math.log(bytes) / Math.log(k));
                return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
            }

            async deleteHistoryRecord(uploadId) {
            const translations = i18n.translations[i18n.currentLang] || i18n.translations['zh-CN'];
            
            if (!confirm(translations.recordDeleted)) {
                return;
            }

            if (!this.db) {
                console.error('æ•°æ®åº“æœªåˆå§‹åŒ–ï¼Œæ— æ³•åˆ é™¤è®°å½•');
                this.showStatus('æ•°æ®åº“æœªåˆå§‹åŒ–ï¼Œæ— æ³•åˆ é™¤è®°å½•', 'error');
                return;
            }

            try {
                // åˆ é™¤ä¸Šä¼ è®°å½•
                const uploadTransaction = this.db.transaction(['uploads'], 'readwrite');
                const uploadStore = uploadTransaction.objectStore('uploads');
                
                await new Promise((resolve, reject) => {
                    const deleteRequest = uploadStore.delete(uploadId);
                    deleteRequest.onsuccess = () => resolve();
                    deleteRequest.onerror = () => reject(deleteRequest.error);
                });

                // åˆ é™¤ç›¸å…³çš„åˆ†ç‰‡è®°å½•
                const chunkTransaction = this.db.transaction(['chunks'], 'readwrite');
                const chunkStore = chunkTransaction.objectStore('chunks');
                const chunkIndex = chunkStore.index('uploadId');
                
                await new Promise((resolve, reject) => {
                    const chunkRequest = chunkIndex.openCursor(IDBKeyRange.only(uploadId));
                    chunkRequest.onsuccess = (event) => {
                        const cursor = event.target.result;
                        if (cursor) {
                            cursor.delete();
                            cursor.continue();
                        } else {
                            resolve();
                        }
                    };
                    chunkRequest.onerror = () => reject(chunkRequest.error);
                });

                this.showModal(translations.deleteSuccess, 'success', translations.deleteSuccess);
                this.loadHistory(); // é‡æ–°åŠ è½½å†å²è®°å½•
            } catch (error) {
                console.error('åˆ é™¤è®°å½•å¤±è´¥:', error);
                this.showModal(translations.deleteFailed, 'error', translations.deleteFailed);
            }
        }
        }

        // åˆå§‹åŒ–ä¸Šä¼ å™¨
        let fileUploader;
        
        document.addEventListener('DOMContentLoaded', () => {
            // åˆå§‹åŒ–è¯­è¨€
            initLanguage();
            
            // å»¶è¿Ÿè°ƒç”¨setLanguageä»¥ç¡®ä¿DOMå…ƒç´ å·²ç»åŠ è½½
            setTimeout(() => {
                setLanguage(i18n.currentLang);
            }, 0);
            
            // åˆå§‹åŒ–æ–‡ä»¶ä¸Šä¼ å™¨
            fileUploader = new FileUploader();
        });
    </script>
</body>
</html>